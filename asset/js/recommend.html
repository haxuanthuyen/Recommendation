<!DOCTYPE html>
<html lang="en">
<meta charset="UTF-8">
<title>Recommend item</title>
<link rel="stylesheet" type="text/css" href="asset/css/style-recommend.css" media="all">
<script src="asset/js/jquery.js"></script>
</head>
<body>
<div class=""></div>
<div class="containerrc">
    <div class="sText">
        <span class="text1">Gợi ý dựa trên các sản phẩm bạn đã xem</span>
        <span class="text2">Trang 1/5</span>
    </div>
    <div class="slider_warraper">
        <ul style="width: 6060px; left: 0px" id="image_slider_2" class="image_slider"></ul>
    </div>
    <a id="prevrc_2" class="sButton prev" href="javascript:void(0)"></a>
    <a id="nextrc_2" class="sButton next" href="javascript:void(0)"></a>
    <script>

        $(document).ready(function(){
            var indexOfPage=1;
            $("#prevrc_2").click(function(){
                loadJson();
                var positionSlider = $("#image_slider_2").position().left;
                if (positionSlider != 0) {
                    $("#image_slider_2").animate({left: "+=1030px"}, 600);
                    indexOfPage--;
                    $(".text2").text("Trang " + indexOfPage + "/5");
                }
            });

            $("#nextrc_2").click(function(){
                var positionSlider = $("#image_slider_2").position().left;
                if (positionSlider == -1030*4) {
                    $("#image_slider_2").animate({left: "0px"}, 600);
                    indexOfPage=1;
                    $(".text2").text("Trang " + indexOfPage + "/5");
                }else {
                    $("#image_slider_2").animate({left: "-=1030px"}, 600);
                    indexOfPage++;
                    $(".text2").text("Trang " + indexOfPage + "/5");
                }
            });
        });



        function loadJson() {
            var xmlhttp = new XMLHttpRequest();
            xmlhttp.onreadystatechange = function() {
                if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                    var lstJson = JSON.parse(xmlhttp.responseText);
                   showData(lstJson);
                }
            };
            xmlhttp.open("GET", "http://localhost:6677/json", true);
            xmlhttp.send();
        }

        function showData(lstJson) {
            for(var i = 1; i < lstJson.products.length; i++) {
                var text = '<li>' +
                '<div class="sImage">' +
                '<a href="' + lstJson.products[i].url + '" title="' + lstJson.products[i].title + '"><img src="' + lstJson.products[i].imgUrl + '"></a>' +
                '</div>' +
                '<div class="textTitle">' +
                '<a href="' + lstJson.products[i].url + '" title="' + lstJson.products[i].title + '">' +  lstJson.products[i].title + '</a>' +
                '</div>' +
                '<div class="price">' +
                '<span class="newPrice">' + lstJson.products[i].sellPrice + '<span>đ</span></span>' +
                '<span class="oldPrice">' + lstJson.products[i].price + '<span>đ</span></span>' +
                '</div>' +
                '</li>';
                $("#image_slider_2").append(text);
            }
        }

        loadJson();
    </script>
</div>
</body>
</html>